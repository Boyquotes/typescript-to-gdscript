# typescript-to-gdscript

Convert TypeScript type definitions into concrete models in GDScript for godot

This utility enables a pipeline where TypeScript files containing interfaces can be transformed into gdscript classes.

The classes can then ingest data sent across http or WebSocket requests with some minimal validation against the TypeScript interface.

This enables strongly typed communication between TypeScript and the Godot game engine.

## Usage

Usage:

```
typescript-to-gdscript [--debug-print] templatefile.gd.tmpl outputdir input1.ts [input2.ts...]
```

Reads all interfaces from input.ts files exports them to `outputdir/[InterfaceName].gd` files.
Uses templatefile.gd.tmpl as the template.

## Templates

Templates use the [tinytemplate syntax](https://docs.rs/tinytemplate/latest/tinytemplate/syntax/index.html). See the [example template](./gdscript-model.gd.tmpl).

## Output

The example template outputs a gdscript 'model' class which has a constructor that accepts an optional `Array` or `Dictionary` object, as well as an `update` method which allows the model to be updated in place.

Properties of the incoming interface are mapped to additional 'model' class files and imported automatically with `preload`.

### Example Output

```Python
extends Reference
# Generated by typsecript-to-gdscript. Do not edit by hand.
# You can extend this in another class to override behaviors
# Model for TestInterface typescript interface in "test-fixtures/test-interface.ts"
const "./ImportedInterface.gd" = preload(ImportedInterface)

var id: int
var str_key: String
var float_key: float
var bool_key: bool
var imported: ImportedInterface
var record_object: TestInterface
var array: Array

func _init(src: Dictionary = {}):
    update(src)

func update(src: Dictionary):
    # custom import logic can be added by overriding this function

    id = data.id
    str_key = data.strKey
    float_key = data.floatKey
    bool_key = data.boolKey
    imported = ImportedInterface.new(data.imported)
    record_object = {}
    for __key__ in src.recordObject:
        var __value__ = src.recordObject[__key__]
        record_object[__key__] = TestInterface.new(__value__)

    array = []
    for __item__ in src.array:
        array.append(ImportedInterface.new(__item__))
```

# Getting Started
## Set up Rust

- Install rustup
  `curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh` or `rustup`
- Install `rust-analyzer` and `CodeLLDB` extensions in vscode.
- Restart VsCode

## Building and coding with Rust

`cargo run -- [arguments]` to run the program.

Add `#![allow(warnings)]` to the top of the file to ignore warnings while writing code
